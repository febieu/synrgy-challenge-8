name: Build & Test Workflow Dispatch

on:
  workflow_dispatch:
    inputs:
      variants:
        description: Select Variant
        required: true
        default: debug
        type: choice
        options:
          - 'debug'
          - 'release'
        notes:
          description: Enter release notes
          required: false
          type: string

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Set up JDK 17
        uses: actions/setup-java@v2
        with:
          distribution: 'adopt'
          java-version: '17
      - uses: actions/checkout@v3
      - name: Grant execute permission to gradlew
        run: chmod +x ./gradlew
      - name: Map options
        uses: kanga333/variable-mapper@master
        id: mapper
        with:
          key: ${{inputs.variants}}
          map: |
            {
              "debug":{
              "build_types": "Debug"
              },
              "release": {
              "build_type": "Release"
              }
            }
          export_to: env

      - name: deploy
        run: |
          ./gradlew assemble${{env.build_type}}
